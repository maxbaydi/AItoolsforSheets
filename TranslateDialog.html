<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <style>
       :root {
            /*  переменные :root остаются без изменений */
            --background-color: #f0f4f8;
            --primary-color-1: #ffffff;
            --primary-color-2: #e0e0e0;
            --primary-color-3: #2196f3;
            --text-color: #555555;
            --text-color-headline: #222222;
            --text-color-sub: #777777;
            --button-text-color: #ffffff;
            --border-color: #e0e0e0;
            --error-color: #d32f2f;
            --success-color: #4CAF50;
            --button-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
            --button-hover-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
            --input-bg: #ffffff;
            --input-text: #222222;
            --input-border: #e0e0e0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 5px;
            background-color: var(--background-color);
            color: var(--text-color);
            font-size: 10px;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            justify-content: flex-start;
        }

       .container {
            background-color: transparent;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.3);
            width: 100%;
            max-width: 280px;
            box-sizing: border-box;
            padding-bottom: 40px;
        }

        .input-group {
            margin-bottom: 10px;
        }
        /*  стиль для горизонтального input-group */
        .input-group-row {
            display: flex;          /*  flex контейнер */
            align-items: center;     /*  выравнивание элементов по центру ВЕРТИКАЛИ */
            gap: 10px;          /*  расстояние между элементами */
        }


        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: var(--text-color-headline);
            font-size: 12px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }
        /* Стиль для label сверху поля ввода - УПРОЩЕН */
        label.top-label {
          display: block;
          margin-bottom: 5px; /*  отступ от label до поля ввода */
        }


       input[type="text"],
        input[type="number"] {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
            margin-bottom: 5px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--input-bg);
            color: var(--input-text);
            font-family: inherit;
            font-size: 14px;
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.03);
            backdrop-filter: blur(3px);
            transition: all 0.2s ease;
            /*flex-grow: 1;  поле ввода занимает доступное место */
            /*min-width: 0;  для правильного сжатия */
            text-align: left; /*  Выравнивание текста по левому краю */
        }
        input[type="text"]:focus, input[type="number"]:focus {
            outline: none;
            border-color: var(--primary-color-3);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
       }

       input[type="text"]::placeholder, input[type="number"]::placeholder {
            color: var(--text-color-sub);
            font-size: 0.85em; /* Размер шрифта */
            font-style: italic;
        }

        .button-group {
            display: flex;
            gap: 8px;
            margin-top: 15px;
            flex-wrap: wrap;/*добавил перенос, если кнопок будет много*/
            justify-content: space-between;/* Добавил */
        }
        .button-group-column {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            margin-top: 10px;
        }

       .custom-button {
            padding: 8px 16px;
            border: 1px solid transparent; /* Добавляем прозрачную границу */
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 12px;
            transition: all 0.2s ease;
            background-color: var(--primary-color-3);
            color: var(--button-text-color);
            box-shadow: var(--button-shadow);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-flex; /* Используем flexbox */
            align-items: center;
            justify-content: center;
            width: auto; /* Автоматическая ширина */
            min-width: 20px; /* Минимальная ширина */
        }

       .custom-button:hover:not(:disabled) {
            box-shadow: var(--button-hover-shadow);
            transform: translateY(-1px) scale(1.02);
            background-color: #1e88e5; /* Немного меняем цвет */
            border-color: var(--primary-color-2); /* Добавляем границу при наведении */
        }
      .custom-button:active{
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.03);
            transform: translateY(0) scale(0.98);
       }
       /* КНОПКА ОЧИСТИТЬ */
       .delete-button {
            background-color: var(--primary-color-1); /* Белый фон */
            color: var(--text-color-headline);
            border: 1px solid var(--border-color); /* Рамка */
           /* добавил */
            padding: 6px 10px;
            font-size: 0.75em;
            width: auto;
        }
        .delete-button:hover {
             background-color: rgba(255, 255, 255, 0.5); /* Фон при наведении */
             border-color: var(--primary-color-3); /* Цвет границы */
         }
       button:disabled {
            opacity: 0.5; /* Полупрозрачность */
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }


        #error-message,
        #status-message {
            padding: 10px;
            margin-top: 15px; /* Отступ сверху */
            border-radius: 8px;
            display: none;
            word-wrap: break-word;
            border: 1px solid transparent; /* Прозрачная граница */
            font-weight: 400;
            opacity: 0.95;
            font-size: 0.9em; /* Размер текста */
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
            transition: all 0.2s ease;
        }
      .message.error {
            background-color: #fde0e0; /* Цвет фона */
            color: #d32f2f; /* Цвет текста */
            border-color: #fccaca;
         }

      .message.success {
            background-color: #e6f4ea; /* Цвет фона */
            color:  var(--success-color);
            border-color: #c8e6c9;
         }

       .message.visible {
            display: block; /* Показываем сообщение */
        }
      /*  */
      @keyframes fadeIn {
          from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }


        .progress-indicator {
            display: none; /* Скрыт по умолчанию */
            margin-top: 10px;/* Отступ сверху */
            text-align: center;
            color: var(--text-color-headline); /* Цвет текста */
            font-size: 1em; /* Размер шрифта */
            font-weight: 600;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
            transition: opacity 0.2s ease;
        }
      .progress-indicator.visible {
            display: block;
            opacity: 1; /* Показываем с анимацией */
        }

       .spinner {
             display: inline-block;
             width: 16px;  /* Уменьшаем размер спиннера */
             height: 16px; /* Уменьшаем размер спиннера */
             border: 2px solid rgba(255, 255, 255, 0.3); /* Цвет фона спиннера */
             border-radius: 50%;
             border-top-color: var(--primary-color-3); /* Цвет вращающейся части */
             animation: spin 0.6s linear infinite; /* Ускоряем анимацию */
             margin-right: 6px; /* Отступ справа */
             vertical-align: middle;
         }
       @keyframes spin {
          0%   { transform: rotate(0deg);   }
          100% { transform: rotate(360deg); }
       }
       /*  стиль для кнопки "Сбросить температуру" */
        #resetTemperatureButton {
            text-transform: uppercase;
            font-size: 0.75em;
            letter-spacing: 0.05em;
            font-weight: 500;
            color: var(--button-text-color);
            box-shadow: var(--button-shadow);
            padding: 6px 12px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: auto; /*  авто ширина */
            height: auto;
            background-color: var(--primary-color-1); /* Белый фон */
            color: var(--text-color-headline);
            border: 1px solid var(--border-color); /* Рамка */
        }

        #resetTemperatureButton:hover:not(:disabled) {
            box-shadow: var(--button-hover-shadow);
            transform: translateY(-1px) scale(1.02);
            background-color: #1e88e5; /* Немного меняем цвет */
            border-color: var(--primary-color-2); /* Добавляем границу при наведении */
        }
        #resetTemperatureButton:active {
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.03);
            transform: translateY(0) scale(0.98);
       }
        /* Новые стили для общего сброса */
        #resetAllSettingsButton {
            background-color: var(--primary-color-1); /* Белый фон */
            color: var(--text-color-headline);
            border: 1px solid var(--border-color); /* Рамка */
            margin-top: 10px; /* Добавляем отступ сверху */
            /* Другие стили, если нужно */
        }
         #resetAllSettingsButton:hover:not(:disabled) {
            box-shadow: var(--button-hover-shadow);
            transform: translateY(-1px) scale(1.02);
            background-color: #1e88e5; /* Немного меняем цвет */
            border-color: var(--primary-color-2); /* Добавляем границу при наведении */
        }
        #resetAllSettingsButton:active {
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.03);
            transform: translateY(0) scale(0.98);
       }
       /* Добавляем стиль для чекбокса */
       .checkbox-label {
           display: flex;
           align-items: center;
           margin-bottom: 10px;
       }

       #freeOnlyCheckbox {
           margin-right: 5px;
           /*  стили, если нужно */
       }

       /* Стили для всплывающих подсказок */
        .tooltip {
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 100%;
            background-color: rgba(51, 51, 51, 0.9);
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
            pointer-events: none;
            white-space: nowrap;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16);
        }
        
        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: rgba(51, 51, 51, 0.9) transparent transparent transparent;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        /* Стили для выпадающих списков (унифицированные) */
        select {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--input-bg);
            color: var(--input-text);
            font-family: inherit;
            font-size: 14px;
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.03);
            appearance: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        select:focus {
            outline: none;
            border-color: var(--primary-color-3);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }
        
        /* Стиль для обертки выпадающих списков */
        .select-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .select-wrapper::after {
            content: '▼';
            position: absolute;
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
            color: var(--text-color-sub);
            pointer-events: none;
            font-size: 0.8em;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="input-group">
            <label for="language">Введите название языка:</label>
            <input type="text" id="language" placeholder="Например: Немецкий" autocomplete="off">
            <div class="select-wrapper">
                <select id="commonLanguages" onchange="selectFromDropdown()">
                    <option value="" selected disabled>Популярные языки</option>
                    <option value="Английский">Английский</option>
                    <option value="Русский">Русский</option>
                    <option value="Китайский">Китайский</option>
                    <option value="Испанский">Испанский</option>
                    <option value="Французский">Французский</option>
                    <option value="Немецкий">Немецкий</option>
                </select>
            </div>
        </div>
        <div class="input-group">
            <label for="temperature" class="top-label">Температура (0-1):</label>
            <div class="input-group input-group-row">
                <input type="number" id="temperature" step="0.01" min="0" max="1" placeholder="0.1">
                <button onclick="resetTemperature('temperature')" class="custom-button delete-button">
                    Сброс
                </button>
            </div>
        </div>
        
        <div class="input-group">
            <label for="modelSelect" class="top-label">Модель перевода:</label>
            <div class="select-wrapper">
                <select id="modelSelect">
                    <option value="default">По умолчанию</option>
                    <option value="google/gemma-3-27b-it:free">Google Gemma 3 27B</option>
                    <option value="qwen/qwen3-235b-a22b:free">Qwen 3 235B</option>
                    <option value="google/learnlm-1.5-pro-experimental:free">Google LearnLM 1.5 Pro</option>
                    <option value="meta-llama/llama-4-maverick:free">Llama 4 Maverick</option>
                    <option value="mistralai/mistral-7b-instruct:free">Mistral 7B</option>
                </select>
            </div>
        </div>

        <div id="recentLanguages" class="input-group" style="display: none;">
            <label>Недавно использованные:</label>
            <div id="recentLanguageChips" class="language-chips-container"></div>
        </div>

        <div class="button-group">
            <!--  Убрал кнопку "Отмена" -->
            <button onclick="translateCell()" id="translateButton" class="custom-button tooltip">
                Перевести
                <span class="tooltiptext">Начать процесс перевода выделенного текста</span>
            </button>
        </div>

        <div id="progress" class="progress-indicator">
            <span class="spinner"></span>  Перевод...
        </div>

        <div id="error-message" class="message"></div>
        <div id="status-message" class="message"></div>

        <!-- Разделитель -->
        <div class="separator" style="margin: 20px 0; border-top: 1px solid var(--border-color); position: relative;">
            <span style="position: absolute; top: -10px; left: 50%; transform: translateX(-50%); background: var(--background-color); padding: 0 10px; color: var(--text-color-sub); font-size: 12px;">
                Google Translate
            </span>
        </div>

        <!-- Секция Google Translate -->
        <div class="google-translate-section">
            <div class="input-group">
                <label for="sourceLanguage">Язык оригинала:</label>
                <input type="text" id="sourceLanguageInput" placeholder="Например: Английский" autocomplete="off">
                <div class="select-wrapper">
                    <select id="sourceLanguage" onchange="updateSourceLanguageInput()">
                        <option value="auto" selected>Определить автоматически</option>
                        <option value="en">Английский</option>
                        <option value="ru">Русский</option>
                        <option value="zh-CN">Китайский</option>
                        <option value="es">Испанский</option>
                        <option value="fr">Французский</option>
                        <option value="de">Немецкий</option>
                    </select>
                </div>
            </div>

            <div class="input-group">
                <label for="targetLanguage">Язык перевода:</label>
                <input type="text" id="targetLanguageInput" placeholder="Например: Русский" autocomplete="off">
                <div class="select-wrapper">
                    <select id="targetLanguage" onchange="updateTargetLanguageInput()">
                        <option value="en">Английский</option>
                        <option value="ru" selected>Русский</option>
                        <option value="zh-CN">Китайский</option>
                        <option value="es">Испанский</option>
                        <option value="fr">Французский</option>
                        <option value="de">Немецкий</option>
                    </select>
                </div>
            </div>

            <div class="button-group">
                <button onclick="quickTranslate()" id="quickTranslateButton" class="custom-button tooltip">
                    Быстрый перевод
                    <span class="tooltiptext">Перевести с помощью Google Translate</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        let isTranslating = false;

        class UIManager {
            static setLoading(isLoading) {
                const button = document.getElementById('translateButton');
                const progress = document.getElementById('progress');
                button.disabled = isLoading;
                progress.classList.toggle('visible', isLoading);
            }

            static showMessage(message, type = 'status') {
                const errorElement = document.getElementById('error-message');
                const statusElement = document.getElementById('status-message');
          			errorElement.classList.remove('visible');
          			statusElement.classList.remove('visible');
                if (type === 'error') {
                    errorElement.textContent = message;
                    errorElement.classList.add('visible');
                } else {
                    statusElement.textContent = message;
                    statusElement.classList.add('visible');
                }
            }

            static clearMessages() {
                document.getElementById('error-message').classList.remove('visible');
                document.getElementById('status-message').classList.remove('visible');
            }
        }

       function resetTemperature(fieldId) {
          document.getElementById(fieldId).value = ''; // fieldId
       }

        function selectLanguage(language) {
            document.getElementById('language').value = language;
            UIManager.clearMessages();
        }

        function selectFromDropdown() {
            const dropdown = document.getElementById('commonLanguages');
            const selectedLanguage = dropdown.options[dropdown.selectedIndex].value;
            selectLanguage(selectedLanguage);
            // После выбора сбрасываем селект на дефолтный вариант
            dropdown.selectedIndex = 0;
        }

        // Добавляем историю недавно использованных языков
        let recentLanguages = [];
        
        // Загрузка последних использованных языков из localStorage
        function loadRecentLanguages() {
            const savedLanguages = localStorage.getItem('recentLanguages');
            if (savedLanguages) {
                recentLanguages = JSON.parse(savedLanguages);
                updateRecentLanguagesDisplay();
            }
        }
        
        function updateRecentLanguagesDisplay() {
            const container = document.getElementById('recentLanguageChips');
            container.innerHTML = '';
            
            if (recentLanguages.length > 0) {
                document.getElementById('recentLanguages').style.display = 'block';
                
                recentLanguages.slice(0, 5).forEach(lang => {
                    const chip = document.createElement('div');
                    chip.className = 'language-chip';
                    chip.textContent = lang;
                    chip.onclick = () => selectLanguage(lang);
                    container.appendChild(chip);
                });
            } else {
                document.getElementById('recentLanguages').style.display = 'none';
            }
        }
        
        function addToRecentLanguages(language) {
            // Удаляем язык, если он уже в списке
            recentLanguages = recentLanguages.filter(lang => lang !== language);
            
            // Добавляем в начало списка
            recentLanguages.unshift(language);
            
            // Ограничиваем список до 5 языков
            if (recentLanguages.length > 5) {
                recentLanguages = recentLanguages.slice(0, 5);
            }
            
            // Сохраняем в localStorage
            localStorage.setItem('recentLanguages', JSON.stringify(recentLanguages));
            
            // Обновляем отображение
            updateRecentLanguagesDisplay();
        }

        // Сохранение модели перевода
        function saveSelectedModel() {
            const model = document.getElementById('modelSelect').value;
            if (model !== 'default') {
                localStorage.setItem('lastUsedModel', model);
            }
        }
        
        // Загрузка выбранной модели при загрузке страницы
        function loadSelectedModel() {
            const model = localStorage.getItem('lastUsedModel');
            if (model) {
                document.getElementById('modelSelect').value = model;
            }
        }

        async function translateCell() {
            const language = document.getElementById('language').value.trim();
            let temperature = document.getElementById('temperature').value.trim();
            const modelSelect = document.getElementById('modelSelect');
            const model = modelSelect.value !== 'default' ? modelSelect.value : null;
            
            if (temperature) {
                temperature = parseFloat(temperature);
                if (isNaN(temperature) || temperature < 0 || temperature > 1) {
                    UIManager.showMessage('Неверное значение температуры. Должно быть число от 0 до 1.', 'error');
                    return;
                }
            } else {
                temperature = null;
            }

            if (!validateInput(language)) return;

            isTranslating = true;
            UIManager.setLoading(true);
            UIManager.clearMessages();

            try {
                const range = await getSelectedRange();
                if (!range) {
                    throw new Error('Не выбран диапазон для перевода');
                }
                
                // Сохраняем данные в историю и localStorage
                addToRecentLanguages(language);
                localStorage.setItem('lastUsedLanguage', language);
                saveSelectedModel();
                
                const result = await new Promise((resolve, reject) => {
                    google.script.run
                        .withSuccessHandler(resolve)
                        .withFailureHandler(reject)
                        .translateRangeWithModel(language, range, temperature, model);
                });

                UIManager.showMessage(result, 'status');
            } catch (error) {
                UIManager.showMessage(error.message || 'Произошла ошибка при переводе', 'error');
            } finally {
                isTranslating = false;
                UIManager.setLoading(false);
            }
        }

        function validateInput(language) {
            if (!language) {
                UIManager.showMessage('Введите название языка', 'error');
                return false;
            }
            return true;
        }

        function getSelectedRange() {
            return new Promise((resolve, reject) => { // Добавил reject
                google.script.run
                    .withSuccessHandler(resolve)
                    .withFailureHandler((err) => { // Исправил обработку ошибок
                        UIManager.showMessage('Ошибка получения выбранного диапазона: ' + err.message, 'error');
                        reject(err); // Reject
                    })
                    .getSelectedRangeA1Notation();
            });
        }

        // Обработка нажатия Enter в поле ввода
        document.getElementById('language').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                translateCell();
            }
        });

        // Сохранение последнего использованного языка
        document.addEventListener('DOMContentLoaded', function () {
            const lastLanguage = localStorage.getItem('lastUsedLanguage');
            if (lastLanguage) {
                document.getElementById('language').value = lastLanguage;
            }
            //  загружаем температуру
            loadInitialTemperature();
            // Загружаем недавно использованные языки
            loadRecentLanguages();
            // Загружаем выбранную модель
            loadSelectedModel();
        });

         //Сохранение языка при переводе
        const originalTranslateCell = translateCell;
        translateCell = async function(){
            const language = document.getElementById('language').value.trim();
            if(language){
                localStorage.setItem('lastUsedLanguage', language);
            }
            await originalTranslateCell();
        }

      function loadInitialTemperature() { //  функция
          google.script.run.withSuccessHandler(temperature => {
          if (temperature) {
              document.getElementById('temperature').value = temperature;
          }
          }).getTemperatureFromClient();
      }

      // Функция для быстрого перевода через Google Translate
        async function quickTranslate() {
            const sourceInput = document.getElementById('sourceLanguageInput').value.trim();
            const targetInput = document.getElementById('targetLanguageInput').value.trim();
            
            // Используем значения из полей ввода или из выпадающих списков
            const sourceLang = sourceInput || document.getElementById('sourceLanguage').value;
            const targetLang = targetInput || document.getElementById('targetLanguage').value;
            
            UIManager.setLoading(true);
            UIManager.clearMessages();
            
            try {
                const result = await new Promise((resolve, reject) => {
                    google.script.run
                        .withSuccessHandler(resolve)
                        .withFailureHandler(reject)
                        .quickTranslateWithGoogle(sourceLang, targetLang);
                });
                
                // Сохраняем выбранные языки в localStorage
                saveGoogleTranslateSettings(
                    document.getElementById('sourceLanguage').value,
                    document.getElementById('targetLanguage').value,
                    sourceInput,
                    targetInput
                );
                
                UIManager.showMessage(result, 'status');
            } catch (error) {
                UIManager.showMessage(error.message || 'Произошла ошибка при быстром переводе', 'error');
            } finally {
                UIManager.setLoading(false);
            }
        }
        
        // Сохранение настроек Google Translate
        function saveGoogleTranslateSettings(sourceCode, targetCode, sourceInput, targetInput) {
            localStorage.setItem('googleTranslateSource', sourceCode);
            localStorage.setItem('googleTranslateTarget', targetCode);
            
            if (sourceInput) {
                localStorage.setItem('googleTranslateSourceInput', sourceInput);
            }
            
            if (targetInput) {
                localStorage.setItem('googleTranslateTargetInput', targetInput);
            }
        }
        
        // Загрузка настроек Google Translate
        function loadGoogleTranslateSettings() {
            const sourceCode = localStorage.getItem('googleTranslateSource');
            const targetCode = localStorage.getItem('googleTranslateTarget');
            const sourceInput = localStorage.getItem('googleTranslateSourceInput');
            const targetInput = localStorage.getItem('googleTranslateTargetInput');
            
            if (sourceCode) {
                document.getElementById('sourceLanguage').value = sourceCode;
            }
            
            if (targetCode) {
                document.getElementById('targetLanguage').value = targetCode;
            }
            
            if (sourceInput) {
                document.getElementById('sourceLanguageInput').value = sourceInput;
            }
            
            if (targetInput) {
                document.getElementById('targetLanguageInput').value = targetInput;
            }
        }
        
        // Обновляем поле ввода при выборе значения из выпадающего списка
        function updateSourceLanguageInput() {
            const select = document.getElementById('sourceLanguage');
            const option = select.options[select.selectedIndex];
            
            if (select.value !== 'auto') {
                document.getElementById('sourceLanguageInput').value = option.text;
            } else {
                document.getElementById('sourceLanguageInput').value = '';
            }
        }
        
        function updateTargetLanguageInput() {
            const select = document.getElementById('targetLanguage');
            const option = select.options[select.selectedIndex];
            document.getElementById('targetLanguageInput').value = option.text;
        }
    </script>
    <script src="shared.js"></script>
</body>
</html>